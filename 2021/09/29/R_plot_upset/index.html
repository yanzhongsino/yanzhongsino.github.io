<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="记录了用R包UpSetR制作upset图展示多集合共享关系的方法。">
<meta property="og:type" content="article">
<meta property="og:title" content="集合可视化 —— upset图">
<meta property="og:url" content="http://example.com/2021/09/29/R_plot_upset/index.html">
<meta property="og:site_name" content="生信技工">
<meta property="og:description" content="记录了用R包UpSetR制作upset图展示多集合共享关系的方法。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/3cabd7b9fd4f1552a69bf5f1797f489be352717a/source/images/R_plot_upset_movies.png?raw=true">
<meta property="og:image" content="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/hexo/source/images/R_plot_upset_mutations.png?raw=true">
<meta property="og:image" content="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/hexo/source/images/R_plot_upset_movies2.png?raw=true">
<meta property="og:image" content="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/hexo/source/images/R_plot_upset_boxplot.png?raw=true">
<meta property="og:image" content="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/3cabd7b9fd4f1552a69bf5f1797f489be352717a/source/images/R_plot_upset_scatter_histogram.png?raw=true">
<meta property="og:image" content="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/3cabd7b9fd4f1552a69bf5f1797f489be352717a/source/images/R_plot_upset_density.png?raw=true">
<meta property="og:image" content="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/hexo/source/wechat/Wechat_public_qrcode.jpg?raw=true">
<meta property="article:published_time" content="2021-09-29T07:56:36.000Z">
<meta property="article:modified_time" content="2022-08-03T11:44:59.474Z">
<meta property="article:author" content="南方枝叶">
<meta property="article:tag" content="R">
<meta property="article:tag" content="R package">
<meta property="article:tag" content="plot">
<meta property="article:tag" content="UpSetR">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/3cabd7b9fd4f1552a69bf5f1797f489be352717a/source/images/R_plot_upset_movies.png?raw=true">

<link rel="canonical" href="http://example.com/2021/09/29/R_plot_upset/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>集合可视化 —— upset图 | 生信技工</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?a7db9ab8b9b3ef3b239a82e4a58e43dc";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">生信技工</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-resume">

    <a href="/resume/index.html" rel="section"><i class="fa fa-file fa-fw"></i>resume</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/09/29/R_plot_upset/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="南方枝叶">
      <meta itemprop="description" content="学习生物信息学的笔记本">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="生信技工">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          集合可视化 —— upset图
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-09-29 15:56:36" itemprop="dateCreated datePublished" datetime="2021-09-29T15:56:36+08:00">2021-09-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-03 19:44:59" itemprop="dateModified" datetime="2022-08-03T19:44:59+08:00">2022-08-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/computer-language/" itemprop="url" rel="index"><span itemprop="name">computer language</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/computer-language/R/" itemprop="url" rel="index"><span itemprop="name">R</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/computer-language/R/plot/" itemprop="url" rel="index"><span itemprop="name">plot</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2021/09/29/R_plot_upset/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/09/29/R_plot_upset/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>7.5k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>7 mins.</span>
            </span>
            <div class="post-description">记录了用R包UpSetR制作upset图展示多集合共享关系的方法。</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <div align="middle"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=298 height=52 src="//music.163.com/outchain/player?type=2&id=1697043&auto=1&height=32"></iframe></div>

<h1 id="1-多集合展示UpSet图"><a href="#1-多集合展示UpSet图" class="headerlink" title="1. 多集合展示UpSet图"></a>1. 多集合展示UpSet图</h1><p>当有多个群组（集合）的数据，想要展示在不同的事物群组（集合）之间的数学或逻辑联系时，可使用韦恩Venn图和UpSet图展示多集合直接的共享关系和各自的独享关系。</p>
<p>当集合数量少于等于5个时，多用韦恩图；当集合数量大于5个时，多用upset图。</p>
<p>韦恩图的绘制推荐使用R包gplots，参考博文<a target="_blank" rel="noopener" href="https://yanzhongsino.github.io/2021/09/29/R_plot_venn/">韦恩图</a>；upset图的绘制推荐使用R包UpSetR，参考博文。</p>
<h2 id="1-1-应用场景"><a href="#1-1-应用场景" class="headerlink" title="1.1. 应用场景"></a>1.1. 应用场景</h2><ol>
<li>利用orthofinder找到的不同物种的orthogroups的结果来绘制Venn Diagram韦恩图或者UpSet plot图，查看不同物种间共享的orthogroups的数量关系。</li>
</ol>
<h2 id="1-2-数据准备"><a href="#1-2-数据准备" class="headerlink" title="1.2. 数据准备"></a>1.2. 数据准备</h2><p>UpSetR的输入文件是表格形式，第一列是数据分类信息，后面列是每一个集合占一列（每个物种占一列），表格内容是1&#x2F;0表示集合在每一个类别是否有数据。</p>
<h3 id="1-2-1-UpSetR自带数据"><a href="#1-2-1-UpSetR自带数据" class="headerlink" title="1.2.1. UpSetR自带数据"></a>1.2.1. UpSetR自带数据</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">movies <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span>system.file<span class="punctuation">(</span><span class="string">&quot;extdata&quot;</span><span class="punctuation">,</span> <span class="string">&quot;movies.csv&quot;</span><span class="punctuation">,</span> package <span class="operator">=</span> <span class="string">&quot;UpSetR&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> sep<span class="operator">=</span><span class="string">&quot;;&quot;</span><span class="punctuation">)</span> <span class="comment"># 载入UpSetR包提供的电影数据用作示例。第一行是电影的类别名称，第一列是电影名，第二列是电影上映年度，后面列中的1/0是代表电影是否属于相应的类别。</span></span><br><span class="line">mutations <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span>system.file<span class="punctuation">(</span><span class="string">&quot;extdata&quot;</span><span class="punctuation">,</span> <span class="string">&quot;mutations.csv&quot;</span><span class="punctuation">,</span> package <span class="operator">=</span> <span class="string">&quot;UpSetR&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;,&quot;</span><span class="punctuation">)</span> <span class="comment"># 载入UpsetR包提供的突变数据用作示例。第一行是不同的基因简称，第一列是基因特征ID，数据中的1/0是代表基因是否有对应的特征。</span></span><br><span class="line"></span><br><span class="line">head<span class="punctuation">(</span>movies<span class="punctuation">)</span> <span class="comment"># 大致浏览一下该数据集,数据集太长，就只看前几列</span></span><br><span class="line">View<span class="punctuation">(</span>movies<span class="punctuation">)</span> <span class="comment"># 弹出窗口，可查看数据。</span></span><br><span class="line"></span><br><span class="line">head<span class="punctuation">(</span>mutations<span class="punctuation">)</span> <span class="comment"># 大致浏览一下该数据集,数据集太长，就只看前几列</span></span><br><span class="line">View<span class="punctuation">(</span>mutations<span class="punctuation">)</span> <span class="comment"># 弹出窗口，可查看数据。</span></span><br></pre></td></tr></table></figure>
<br>

<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>movies<span class="punctuation">)</span></span><br><span class="line">                                Name ReleaseDate Action Adventure Children Comedy Crime Documentary Drama Fantasy Noir Horror Musical Mystery Romance SciFi Thriller War Western AvgRating Watches</span><br><span class="line"><span class="number">1</span>                   Toy Story <span class="punctuation">(</span><span class="number">1995</span><span class="punctuation">)</span>        <span class="number">1995</span>      <span class="number">0</span>         <span class="number">0</span>        <span class="number">1</span>      <span class="number">1</span>     <span class="number">0</span>           <span class="number">0</span>     <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>     <span class="number">0</span>        <span class="number">0</span>   <span class="number">0</span>       <span class="number">0</span>      <span class="number">4.15</span>    <span class="number">2077</span></span><br><span class="line"><span class="number">2</span>                     Jumanji <span class="punctuation">(</span><span class="number">1995</span><span class="punctuation">)</span>        <span class="number">1995</span>      <span class="number">0</span>         <span class="number">1</span>        <span class="number">1</span>      <span class="number">0</span>     <span class="number">0</span>           <span class="number">0</span>     <span class="number">0</span>       <span class="number">1</span>    <span class="number">0</span>      <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>     <span class="number">0</span>        <span class="number">0</span>   <span class="number">0</span>       <span class="number">0</span>      <span class="number">3.20</span>     <span class="number">701</span></span><br><span class="line"><span class="number">3</span>            Grumpier Old Men <span class="punctuation">(</span><span class="number">1995</span><span class="punctuation">)</span>        <span class="number">1995</span>      <span class="number">0</span>         <span class="number">0</span>        <span class="number">0</span>      <span class="number">1</span>     <span class="number">0</span>           <span class="number">0</span>     <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>       <span class="number">1</span>     <span class="number">0</span>        <span class="number">0</span>   <span class="number">0</span>       <span class="number">0</span>      <span class="number">3.02</span>     <span class="number">478</span></span><br><span class="line"><span class="number">4</span>           Waiting to Exhale <span class="punctuation">(</span><span class="number">1995</span><span class="punctuation">)</span>        <span class="number">1995</span>      <span class="number">0</span>         <span class="number">0</span>        <span class="number">0</span>      <span class="number">1</span>     <span class="number">0</span>           <span class="number">0</span>     <span class="number">1</span>       <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>     <span class="number">0</span>        <span class="number">0</span>   <span class="number">0</span>       <span class="number">0</span>      <span class="number">2.73</span>     <span class="number">170</span></span><br><span class="line"><span class="number">5</span> Father of the Bride Part II <span class="punctuation">(</span><span class="number">1995</span><span class="punctuation">)</span>        <span class="number">1995</span>      <span class="number">0</span>         <span class="number">0</span>        <span class="number">0</span>      <span class="number">1</span>     <span class="number">0</span>           <span class="number">0</span>     <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>     <span class="number">0</span>        <span class="number">0</span>   <span class="number">0</span>       <span class="number">0</span>      <span class="number">3.01</span>     <span class="number">296</span></span><br><span class="line"><span class="number">6</span>                        Heat <span class="punctuation">(</span><span class="number">1995</span><span class="punctuation">)</span>        <span class="number">1995</span>      <span class="number">1</span>         <span class="number">0</span>        <span class="number">0</span>      <span class="number">0</span>     <span class="number">1</span>           <span class="number">0</span>     <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>     <span class="number">0</span>        <span class="number">1</span>   <span class="number">0</span>       <span class="number">0</span>      <span class="number">3.88</span>     <span class="number">940</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>mutations<span class="punctuation">)</span></span><br><span class="line">  Identifier TTN PTEN TP53 EGFR MUC16 FLG RYR2 PCLO PIK3R1 PIK3CA NF1 MUC17 HMCN1 SPTA1 USH2A RB1 PKHD1 OBSCN AHNAK2 RYR3 RELN FRAS1 GPR98 DNAH5 ATRX APOB TCHH SYNE1 LRP2 KEL HRNR DNAH3 COL6A3 MUC5B LAMA1 DSP</span><br><span class="line"><span class="number">1</span>    <span class="number">02</span><span class="operator">-</span><span class="number">0003</span>   <span class="number">0</span>    <span class="number">0</span>    <span class="number">1</span>    <span class="number">1</span>     <span class="number">0</span>   <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>      <span class="number">1</span>      <span class="number">0</span>   <span class="number">0</span>     <span class="number">1</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">1</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span></span><br><span class="line"><span class="number">2</span>    <span class="number">02</span><span class="operator">-</span><span class="number">0033</span>   <span class="number">0</span>    <span class="number">0</span>    <span class="number">1</span>    <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>      <span class="number">1</span>   <span class="number">1</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">1</span>     <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span></span><br><span class="line"><span class="number">3</span>    <span class="number">02</span><span class="operator">-</span><span class="number">0047</span>   <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>    <span class="number">1</span>    <span class="number">0</span>      <span class="number">0</span>      <span class="number">1</span>   <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>    <span class="number">1</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span></span><br><span class="line"><span class="number">4</span>    <span class="number">02</span><span class="operator">-</span><span class="number">0055</span>   <span class="number">1</span>    <span class="number">1</span>    <span class="number">1</span>    <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>     <span class="number">1</span>      <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>      <span class="number">1</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span></span><br><span class="line"><span class="number">5</span>    <span class="number">02</span><span class="operator">-</span><span class="number">2470</span>   <span class="number">0</span>    <span class="number">1</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>    <span class="number">1</span>    <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span></span><br><span class="line"><span class="number">6</span>    <span class="number">02</span><span class="operator">-</span><span class="number">2483</span>   <span class="number">0</span>    <span class="number">0</span>    <span class="number">1</span>    <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>    <span class="number">0</span>    <span class="number">1</span>      <span class="number">0</span>      <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">1</span>    <span class="number">1</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>   <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span></span><br><span class="line">  DNAH8 CNTNAP2 SDK1 NBPF10 DNAH2 NLRP5 MLL3 IDH1 HCN1 FCGBP DOCK5 RIMS2 PCDHA1 MXRA5 HEATR7B2 GRIN2A FGD5 TMEM132D STAG2 SEMA3C SCN9A PRDM9 POM121L12 PIK3CG PDGFRA GABRA6 FLG2 FBN3 FBN2 FAT2 DNAH11 DMD COL1A2</span><br><span class="line"><span class="number">1</span>     <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">1</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>        <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>        <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>         <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>   <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">2</span>     <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>      <span class="number">1</span>     <span class="number">0</span>        <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>        <span class="number">0</span>     <span class="number">0</span>      <span class="number">1</span>     <span class="number">0</span>     <span class="number">0</span>         <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>   <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">3</span>     <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>      <span class="number">1</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>        <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>        <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>         <span class="number">0</span>      <span class="number">0</span>      <span class="number">1</span>      <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>   <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">4</span>     <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>        <span class="number">0</span>      <span class="number">0</span>    <span class="number">1</span>        <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>         <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>   <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">5</span>     <span class="number">0</span>       <span class="number">1</span>    <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">1</span>    <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>        <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>        <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>         <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>   <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">6</span>     <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>    <span class="number">1</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>        <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>        <span class="number">0</span>     <span class="number">0</span>      <span class="number">1</span>     <span class="number">0</span>     <span class="number">0</span>         <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>   <span class="number">0</span>      <span class="number">0</span></span><br><span class="line">  ABCC9 XIRP2 TSHZ2 TEX15 SLIT3 RBM47 PIK3C2G PCDH11X MYH2 MACF1 KSR2 DNAH9 DCHS2 CSMD3 CDH18 BCOR AHNAK ZAN TRRAP THSD7B TAF1L SPAG17 SLCO5A1 SCN10A RYR1 RIMBP2 PLEKHG4B PCDHB7 NPTX2 NOS1 LZTR1</span><br><span class="line"><span class="number">1</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">1</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>       <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>        <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span></span><br><span class="line"><span class="number">2</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>       <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>        <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span></span><br><span class="line"><span class="number">3</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>       <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>        <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span></span><br><span class="line"><span class="number">4</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>       <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>        <span class="number">1</span>      <span class="number">0</span>     <span class="number">0</span>    <span class="number">1</span>     <span class="number">0</span></span><br><span class="line"><span class="number">5</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">1</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>       <span class="number">0</span>      <span class="number">0</span>    <span class="number">0</span>      <span class="number">1</span>        <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span></span><br><span class="line"><span class="number">6</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>       <span class="number">0</span>       <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span>   <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>      <span class="number">0</span>       <span class="number">1</span>      <span class="number">0</span>    <span class="number">0</span>      <span class="number">0</span>        <span class="number">0</span>      <span class="number">0</span>     <span class="number">0</span>    <span class="number">0</span>     <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h3 id="1-2-2-orthofinder数据"><a href="#1-2-2-orthofinder数据" class="headerlink" title="1.2.2. orthofinder数据"></a>1.2.2. orthofinder数据</h3><p>从orthofinder的结果文件Results_Aug14&#x2F;Orthogroups&#x2F;Orthogroups.GeneCount.tsv稍加处理就可以作为输入文件，展示不同物种的orthogroups集合的共享情况。</p>
<p><code>sed -E &quot;s/\t[1-9][0-9]*/\t1/g&quot; Orthogroups.GeneCount.tsv |sed &quot;s/\.pep//g&quot; &gt;orthogroups.upset</code> # 把Orthogroups.GeneCount.tsv中的非零数字替换成1。</p>
<p>在R中用<code>mutations &lt;- read.csv(&quot;orthogroups.upset&quot;, header=TRUE, sep = &quot;\t&quot;)</code>读取orthogroups.upset。</p>
<h2 id="1-3-UpSetR包安装"><a href="#1-3-UpSetR包安装" class="headerlink" title="1.3. UpSetR包安装"></a>1.3. UpSetR包安装</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">install.packages(&quot;UpSetR&quot;); # 安装</span><br><span class="line">library(UpSetR); # 载入UpSetR</span><br><span class="line">require(ggplot2); require(plyr); require(gridExtra); require(grid); # 载入包</span><br></pre></td></tr></table></figure>

<h2 id="1-4-UpSetR包使用"><a href="#1-4-UpSetR包使用" class="headerlink" title="1.4. UpSetR包使用"></a>1.4. UpSetR包使用</h2><h3 id="1-4-1-upset函数"><a href="#1-4-1-upset函数" class="headerlink" title="1.4.1. upset函数"></a>1.4.1. upset函数</h3><ol>
<li><p><code>upset(mutations)</code>可以看到upset图的效果</p>
</li>
<li><p>调整参数做指定数据显示</p>
</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">upset<span class="punctuation">(</span>mutations<span class="punctuation">,</span> </span><br><span class="line">sets <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;MUC16&quot;</span><span class="punctuation">,</span><span class="string">&quot;EGFR&quot;</span><span class="punctuation">,</span><span class="string">&quot;TP53&quot;</span><span class="punctuation">,</span><span class="string">&quot;TTN&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="comment"># 查看特定的几个集合/几种电影类别</span></span><br><span class="line">nset <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span> <span class="comment"># 最多展示多少个集合数据</span></span><br><span class="line">nintersects <span class="operator">=</span> <span class="number">20</span><span class="punctuation">,</span> <span class="comment"># 展示数量多的前多少个交集</span></span><br><span class="line">mb.ratio <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.55</span><span class="punctuation">,</span> <span class="number">0.45</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># 控制上方条形图以及下方点图的比例</span></span><br><span class="line">order.by <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;degree&quot;</span><span class="punctuation">,</span> <span class="string">&quot;freq&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># 交集如何排序，这里先根据degree(数量，交集包含的数字大小)，然后再根据freq(频率，涉及到的交集个数)</span></span><br><span class="line">keep.order <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> <span class="comment"># keep.order按照sets参数的顺序排序</span></span><br><span class="line">decreasing <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">TRUE</span><span class="punctuation">,</span><span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># 变量如何排序；对应order.by参数。这里表示degree降序，freq升序。</span></span><br><span class="line">number.angles <span class="operator">=</span> <span class="number">30</span><span class="punctuation">,</span> <span class="comment"># 调整柱形图上数字角度</span></span><br><span class="line">point.size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> line.size <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> <span class="comment"># 点和线的大小</span></span><br><span class="line">mainbar.y.label <span class="operator">=</span> <span class="string">&quot;Intersection size of gene family&quot;</span><span class="punctuation">,</span>sets.x.label <span class="operator">=</span> <span class="string">&quot;genome size&quot;</span><span class="punctuation">,</span> <span class="comment"># 坐标轴名称</span></span><br><span class="line">text.scale <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1.3</span><span class="punctuation">,</span> <span class="number">1.3</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">1.5</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 六个数字，分别控制c(intersectionsize title, intersection size tick labels, set size title, set size ticklabels, set names, numbers above bars)</span></span><br></pre></td></tr></table></figure>

<img src="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/3cabd7b9fd4f1552a69bf5f1797f489be352717a/source/images/R_plot_upset_movies.png?raw=true" width=100% height=60% title="upset_movies" align=center/>

<p><strong><p align="center">Figure 1. movies upset</p></strong></p>
<h3 id="1-4-2-queries参数"><a href="#1-4-2-queries参数" class="headerlink" title="1.4.2. queries参数"></a>1.4.2. queries参数</h3><p>upset函数中可以添加queries参数，用于突出显示（上色）部分数据。</p>
<ol>
<li><p>queries<br>queries是一个由多个query组成的list；每个query也是一个list，作为一次查询数据并突出显示的请求。</p>
</li>
<li><p>query<br>query也是list格式，由查询函数query和其他参数（param,color,active,query.name）组成，其中query,param是必须设置的参数。</p>
<ul>
<li>query: 指定查询函数，UpSetR有内置(比如intersects)，也可以自定义函数后调用。</li>
<li>param: list格式, 指定query作用的数据。</li>
<li>color：设置颜色，可选设置。</li>
<li>active：显示类型，TRUE&#x2F;T表示用颜色覆盖条形图，FALSE&#x2F;F表示在条形图顶端显示三角形。</li>
<li>query.name：添加query图例名称。</li>
</ul>
</li>
<li><p>queries参数示例</p>
</li>
</ol>
<ul>
<li>把”EGFR”和”TP53”两个基因共同拥有的突变标上蓝色；把”TTN”基因特有的突变在直方图上标为红色。</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">upset<span class="punctuation">(</span>mutations<span class="punctuation">,</span> sets<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;MUC16&quot;</span><span class="punctuation">,</span><span class="string">&quot;EGFR&quot;</span><span class="punctuation">,</span><span class="string">&quot;TP53&quot;</span><span class="punctuation">,</span><span class="string">&quot;TTN&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">queries <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>query <span class="operator">=</span> intersects<span class="punctuation">,</span>  </span><br><span class="line">params <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="string">&quot;EGFR&quot;</span><span class="punctuation">,</span> <span class="string">&quot;TP53&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># 指定作用的数据</span></span><br><span class="line">color <span class="operator">=</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> <span class="comment"># 设置颜色，未设置会调用默认调色板</span></span><br><span class="line">active <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>   <span class="comment"># 条形图被颜色覆盖</span></span><br><span class="line">query.name <span class="operator">=</span> <span class="string">&quot;share EGFR and TP53&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># 添加query图例</span></span><br><span class="line"><span class="built_in">list</span><span class="punctuation">(</span>query <span class="operator">=</span> intersects<span class="punctuation">,</span> params<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span><span class="string">&quot;TTN&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> color<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> active<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<img src="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/hexo/source/images/R_plot_upset_mutations.png?raw=true" width=100% height=60% title="upset_mutations" align=center/>

<p><strong><p align="center">Figure 2. mutations upset</p></strong></p>
<ul>
<li>把同属Drama和Thriller的电影突出显示，把1970-1980的电影标红。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">between &lt;- function(row, min, max)&#123;</span><br><span class="line">  newData &lt;- (row[&quot;ReleaseDate&quot;] &lt; max) &amp; (row[&quot;ReleaseDate&quot;] &gt; min)</span><br><span class="line">&#125; # 自定义between函数</span><br><span class="line"></span><br><span class="line">upset(movies, sets=c(&quot;Drama&quot;,&quot;Comedy&quot;,&quot;Action&quot;,&quot;Thriller&quot;,&quot;Western&quot;,&quot;Documentary&quot;),</span><br><span class="line">      queries = list(list(query = intersects, params = list(&quot;Drama&quot;, &quot;Thriller&quot;)),</span><br><span class="line">                     list(query = between, params=list(1970,1980), color=&quot;red&quot;, active=TRUE)))</span><br></pre></td></tr></table></figure></li>
</ul>
<img src="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/hexo/source/images/R_plot_upset_movies2.png?raw=true" width=100% height=60% title="upset_movies2" align=center/>

<p><strong><p align="center">Figure 3. movies upset 2</p></strong></p>
<h3 id="1-4-3-添加属性图"><a href="#1-4-3-添加属性图" class="headerlink" title="1.4.3. 添加属性图"></a>1.4.3. 添加属性图</h3><ol>
<li>添加箱线图<br>每次最多添加两个箱线图<br><code>upset(movies, boxplot.summary = c(&quot;AvgRating&quot;, &quot;ReleaseDate&quot;)) </code></li>
</ol>
<img src="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/hexo/source/images/R_plot_upset_boxplot.png?raw=true" width=100% height=70% title="upset_boxplot" align=center/>

<p><strong><p align="center">Figure 4. movies upset boxplot</p></strong></p>
<h4 id="1-4-3-1-attribute-plots参数"><a href="#1-4-3-1-attribute-plots参数" class="headerlink" title="1.4.3.1. attribute.plots参数"></a>1.4.3.1. attribute.plots参数</h4><p>attribute.plots参数用于添加属性图，内置有柱形图，散点图，热图等。<br>如果想添加密度曲线图，可以自定义plot函数后添加。</p>
<ol>
<li>添加柱形图和散点图<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">upset<span class="punctuation">(</span>movies<span class="punctuation">,</span> sets<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Drama&quot;</span><span class="punctuation">,</span><span class="string">&quot;Comedy&quot;</span><span class="punctuation">,</span><span class="string">&quot;Action&quot;</span><span class="punctuation">,</span><span class="string">&quot;Thriller&quot;</span><span class="punctuation">,</span><span class="string">&quot;Western&quot;</span><span class="punctuation">,</span><span class="string">&quot;Documentary&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      queries <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>query <span class="operator">=</span> intersects<span class="punctuation">,</span> params <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="string">&quot;Drama&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Thriller&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                     <span class="built_in">list</span><span class="punctuation">(</span>query <span class="operator">=</span> between<span class="punctuation">,</span> params<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span><span class="number">1970</span><span class="punctuation">,</span><span class="number">1980</span><span class="punctuation">)</span><span class="punctuation">,</span> color<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> active<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      attribute.plots<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>gridrows<span class="operator">=</span><span class="number">60</span><span class="punctuation">,</span> <span class="comment"># 添加属性图</span></span><br><span class="line">      plots<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span></span><br><span class="line">        <span class="built_in">list</span><span class="punctuation">(</span>plot<span class="operator">=</span>scatter_plot<span class="punctuation">,</span> <span class="comment"># 散点图</span></span><br><span class="line">        x<span class="operator">=</span><span class="string">&quot;ReleaseDate&quot;</span><span class="punctuation">,</span> y<span class="operator">=</span><span class="string">&quot;AvgRating&quot;</span><span class="punctuation">,</span> <span class="comment"># 指定横纵坐标</span></span><br><span class="line">        queries <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># T表示显示queries定义的颜色</span></span><br><span class="line">        <span class="built_in">list</span><span class="punctuation">(</span>plot<span class="operator">=</span> histogram<span class="punctuation">,</span> x<span class="operator">=</span><span class="string">&quot;ReleaseDate&quot;</span><span class="punctuation">,</span> queries <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># 直方图</span></span><br><span class="line">        ncols <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># 添加的图分两列</span></span><br><span class="line">      query.legend <span class="operator">=</span> <span class="string">&quot;top&quot;</span><span class="punctuation">)</span> <span class="comment"># query图例放在上方</span></span><br></pre></td></tr></table></figure></li>
</ol>
<img src="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/3cabd7b9fd4f1552a69bf5f1797f489be352717a/source/images/R_plot_upset_scatter_histogram.png?raw=true" width=100% height=70% title="upset_scatter_histograms" align=center/>

<p><strong><p align="center">Figure 5. movies upset scatter histograms</p></strong></p>
<ol start="2">
<li>添加密度曲线图</li>
</ol>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#自定义密度曲线</span></span><br><span class="line">another.plot <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>data<span class="punctuation">,</span> x<span class="punctuation">,</span> y<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    data<span class="operator">$</span>decades <span class="operator">&lt;-</span> round_any<span class="punctuation">(</span><span class="built_in">as.integer</span><span class="punctuation">(</span>unlist<span class="punctuation">(</span>data<span class="punctuation">[</span>y<span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="built_in">ceiling</span><span class="punctuation">)</span></span><br><span class="line">    data <span class="operator">&lt;-</span> data<span class="punctuation">[</span>which<span class="punctuation">(</span>data<span class="operator">$</span>decades <span class="operator">&gt;=</span> <span class="number">1970</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">    myplot <span class="operator">&lt;-</span> <span class="punctuation">(</span>ggplot<span class="punctuation">(</span>data<span class="punctuation">,</span> aes_string<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_density<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> factor<span class="punctuation">(</span>decades<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        alpha <span class="operator">=</span> <span class="number">0.4</span><span class="punctuation">)</span> <span class="operator">+</span> theme<span class="punctuation">(</span>plot.margin <span class="operator">=</span> unit<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key.size <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>plyr<span class="punctuation">)</span></span><br><span class="line">upset<span class="punctuation">(</span>movies<span class="punctuation">,</span> main.bar.color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> mb.ratio <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span> queries <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>query <span class="operator">=</span> intersects<span class="punctuation">,</span> </span><br><span class="line">    params <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="string">&quot;Drama&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> active <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">list</span><span class="punctuation">(</span>query <span class="operator">=</span> intersects<span class="punctuation">,</span> </span><br><span class="line">    params <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="string">&quot;Action&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Drama&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> active <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">list</span><span class="punctuation">(</span>query <span class="operator">=</span> intersects<span class="punctuation">,</span> </span><br><span class="line">    params <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="string">&quot;Drama&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Comedy&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Action&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;orange&quot;</span><span class="punctuation">,</span> active <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">    attribute.plots <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>gridrows <span class="operator">=</span> <span class="number">50</span><span class="punctuation">,</span> plots <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>plot <span class="operator">=</span> histogram<span class="punctuation">,</span> </span><br><span class="line">        x <span class="operator">=</span> <span class="string">&quot;ReleaseDate&quot;</span><span class="punctuation">,</span> queries <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">list</span><span class="punctuation">(</span>plot <span class="operator">=</span> scatter_plot<span class="punctuation">,</span> x <span class="operator">=</span> <span class="string">&quot;ReleaseDate&quot;</span><span class="punctuation">,</span> </span><br><span class="line">        y <span class="operator">=</span> <span class="string">&quot;AvgRating&quot;</span><span class="punctuation">,</span> queries <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">list</span><span class="punctuation">(</span>plot <span class="operator">=</span> another.plot<span class="punctuation">,</span> x <span class="operator">=</span> <span class="string">&quot;AvgRating&quot;</span><span class="punctuation">,</span> </span><br><span class="line">        y <span class="operator">=</span> <span class="string">&quot;ReleaseDate&quot;</span><span class="punctuation">,</span> queries <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> ncols <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<img src="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/3cabd7b9fd4f1552a69bf5f1797f489be352717a/source/images/R_plot_upset_density.png?raw=true" width=100% height=70% title="upset_density" align=center/>

<p><strong><p align="center">Figure 6. movies upset density</p></strong></p>
<h1 id="2-references"><a href="#2-references" class="headerlink" title="2. references"></a>2. references</h1><ol>
<li><a target="_blank" rel="noopener" href="https://github.com/hms-dbmi/UpSetR">https://github.com/hms-dbmi/UpSetR</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/324aae3d5ea4">https://www.jianshu.com/p/324aae3d5ea4</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/35303590">https://zhuanlan.zhihu.com/p/35303590</a></li>
</ol>
<hr>
<ul>
<li>欢迎关注微信公众号：<strong>生信技工</strong></li>
<li>公众号主要分享生信分析、生信软件、基因组学、转录组学、植物进化、生物学概念等相关内容，包括生物信息学工具的基本原理、操作步骤和学习心得。</li>
</ul>
<img src="https://github.com/yanzhongsino/yanzhongsino.github.io/blob/hexo/source/wechat/Wechat_public_qrcode.jpg?raw=true" width=50% title="wechat_public_QRcode.png" align=center/>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/R/" rel="tag"># R</a>
              <a href="/tags/R-package/" rel="tag"># R package</a>
              <a href="/tags/plot/" rel="tag"># plot</a>
              <a href="/tags/UpSetR/" rel="tag"># UpSetR</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/09/29/R_plot_venn/" rel="prev" title="集合可视化 —— 文氏图/韦恩图(Venn Diagram)">
      <i class="fa fa-chevron-left"></i> 集合可视化 —— 文氏图/韦恩图(Venn Diagram)
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/10/10/linux_loop/" rel="next" title="shell的几种循环语法">
      shell的几种循环语法 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-%E5%A4%9A%E9%9B%86%E5%90%88%E5%B1%95%E7%A4%BAUpSet%E5%9B%BE"><span class="nav-text">1. 多集合展示UpSet图</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">1.1. 应用场景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87"><span class="nav-text">1.2. 数据准备</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-1-UpSetR%E8%87%AA%E5%B8%A6%E6%95%B0%E6%8D%AE"><span class="nav-text">1.2.1. UpSetR自带数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-2-orthofinder%E6%95%B0%E6%8D%AE"><span class="nav-text">1.2.2. orthofinder数据</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-UpSetR%E5%8C%85%E5%AE%89%E8%A3%85"><span class="nav-text">1.3. UpSetR包安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4-UpSetR%E5%8C%85%E4%BD%BF%E7%94%A8"><span class="nav-text">1.4. UpSetR包使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-1-upset%E5%87%BD%E6%95%B0"><span class="nav-text">1.4.1. upset函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-2-queries%E5%8F%82%E6%95%B0"><span class="nav-text">1.4.2. queries参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-3-%E6%B7%BB%E5%8A%A0%E5%B1%9E%E6%80%A7%E5%9B%BE"><span class="nav-text">1.4.3. 添加属性图</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-4-3-1-attribute-plots%E5%8F%82%E6%95%B0"><span class="nav-text">1.4.3.1. attribute.plots参数</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-references"><span class="nav-text">2. references</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">南方枝叶</p>
  <div class="site-description" itemprop="description">学习生物信息学的笔记本</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">79</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">255</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/yanzhongsino" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yanzhongsino" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yan.zhong.sino@gmail.com" title="E-Mail → mailto:yan.zhong.sino@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2018 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="snowflake-o"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">南方枝叶</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">427k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">6:28</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://yanzhongsino.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "http://example.com/2021/09/29/R_plot_upset/";
    this.page.identifier = "2021/09/29/R_plot_upset/";
    this.page.title = "集合可视化 —— upset图";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://yanzhongsino.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
